<!-- 1. create 2.show channel list -->

{% extends "layout.html" %}
{% block heading %}


Flack

{% endblock %}


{% block body %}


<script> 
    document.addEventListener('DOMContentLoaded',()=>{
        document.querySelector('#submit').disabled = true;

        document.querySelector('#cname').onkeyup = () => {
          if (document.querySelector('#cname').value.length > 0)
              document.querySelector('#submit').disabled = false;
          
          else
            document.querySelector('#submit').disabled = true;
          };
          document.querySelector('#cname').onsubmit =()=>{
       

       
          //clear input field
          document.querySelector('#cname').value='';
          document.querySelector('#submit').disabled = true;
        
          // Stop form from submitting
          return false;
      };
  
      }); 


</script>
  <div class ="container">
    <div class="row">
      <div class="col-lg-4">
        <div class="workspace">
          <div class="sidebar" role="tabpanel">
            <h1 id="printname">Welcome {{name}}</h1>
            <h2>Channels</h2>
          
           
                <ul id="channels">
                  <!-- {% if allchannels is defined %}
                    {% for channel in allchannels %}
                      <li> {{channel}}</li>
                    {%endfor%}
                  {%endif %} -->

                </ul>
                <div class="tab">
                  {% if allchannels is defined %}
                    {% for channel in allchannels %}
                      <button class="tablinks" onclick="openChat(chatonchannel, channel)" id="defaultOpen">{{channel}}</button>
                      {%endfor%}
                      {%endif %}
                </div>
                

                
                
                <form id ="new-channel"  action ="{{ url_for('createchannel') }}" method="POST">
                  <div>
                    <a class ="btn-link " data-toggle="modal" href="#channel" role="button" aria-expanded="false" aria-controls="channel">
                      Create new channel
                    </a>
                    <div class="modal " tabindex="-1" role="dialog" id = "channel">
                      <div class="modal-dialog">
                        <div class="modal-content">
                          <div class="modal-header">
                            <h5 class="modal-title">Enter Display name</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                              <span aria-hidden="true">&times;</span>
                            </button>
                          </div>
                          <div class="modal-body">
                              <input type="text" class="form-control  form-control-lg" autocomplete="off" autofocus placeholder="Display name" name = "cname" id="cname" type="text" >
                              {% if error_msg is defined and error_msg|length > 0 %}
                                <p class="text-danger">{{error_msg}}
                               {%endif%} 

                          </div>
                         

             
                          <div class="modal-footer">
                            <button class="btn btn-primary" id ="submit" onclick ="validateform()">Submit</button>
                            
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
              
                </form>
            </div>
        </div>
     </div>
      <div class="col-lg-8">
        <div class="messages">
          <p>here</p>
        </div>
      </div>

    </div>
  </div>
  <script>
      var errors='{{error_msg}}';
      if (errors.length > 0){
        $('#channel').modal('show');
      }
  </script>
  {% endblock %}